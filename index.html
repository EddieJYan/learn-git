<!DOCTYPE html>
<html lang="ch-zn">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>resume</title>
    <link rel="stylesheet" href="css/index.css?v=1.3">
    <link rel="stylesheet" href="css/slider.css?v=1.0">
</head>

<body style="overflow: hidden;">

    <div style="position: fixed; bottom:0;right:0;">
        <P>做留言板</P>
        <P>MVC化代码</p>
        <P>写异步</p>
    </div>
    <div id="wrapper" data-bbtn="to_wrapper" class="wrapper">
        <header class="page-header">


            <div class="topNavBar noShow">
                <a class="logo" href="#" alt="logo">
                    <span class="rs">RS</span>
                    <span class="card">card</span>
                </a>
                <nav>
                    <ul>
                        <li>
                            <a id="to_wrapper" href="#wrapper" class="actived">关于</a>
                        </li>
                        <li>
                            <a id="to_skills" href="#skills">技能</a>
                        </li>
                        <li>
                            <a id="to_portfolio" href="#portfolio">作品</a>
                        </li>
                        <li class="hasPwin">
                            <a>博客</a>
                            <div class="pwin">
                                <ul>
                                    <li><a href="">选型一</a></li>
                                    <li><a href="">选型二</a></li>
                                </ul>
                            </div>
                        </li>
                        <li>
                            <a>日历</a>
                        </li>
                        <li>
                            <a>联系方式</a>
                        </li>
                        <li class="hasPwin">
                            <a>其他</a>
                            <div class="pwin">
                                <ul>
                                    <li><a href="">选型一</a></li>
                                    <li><a href="">选型二</a></li>
                                </ul>
                            </div>
                        </li>
                    </ul>
                </nav>
            </div>
        </header>

        <main class="noShow">
            <article class="personal-info">
                <div class="content">
                    <img src="images/avatar.jpg" alt="我的头像">
                    <div class="info">
                        <span class="tips">Hello</span>
                        <h1>晏俊</h1>
                        <p>前端开发工程师</p>
                        <hr>
                        <dl>
                            <dt>年龄</dt>
                            <dd>39</dd>
                            <dt>所在城市</dt>
                            <dd>上海</dd>
                            <dt>邮箱</dt>
                            <dd><a href="mailto:eddie_key@163.com">eddie_key@163.com</a></dd>
                            <dt>手机</dt>
                            <dd>13917616917</dd>
                        </dl>
                    </div>
                </div>

                <footer>

                </footer>
            </article>

            <article class="jieshao">
                <a class="btn-download">下载简历（PDF）</a>
                <p>
                    晏俊， 前端工程师，现在在 饥人谷 学习前端课程。
                    技能：前端开发，移动APP开发，小程序开发
                </p>
            </article>

            <article id="chaojilaji"></article>

            <article id="skills" class="skills noShows" data-bbtn="to_skills">
                <h2>技能</h2>
                <ol class="clearfix">
                    <li>
                        <h3>
                            HTML 5 &amp; CSS 3
                        </h3>
                        <div class="progressBar">
                            <div class="progress" data-score="90" style="width: 0%;"></div>
                        </div>
                    </li>
                    <li>
                        <h3>
                            JavaScript
                        </h3>
                        <div class="progressBar">
                            <div class="progress" data-score="40" style="width: 0%"></div>
                        </div>
                    </li>
                    <li>
                        <h3>
                            jQuery
                        </h3>
                        <div class="progressBar">
                            <div class="progress" data-score="70" style="width: 0%"></div>
                        </div>
                    </li>
                    <li>
                        <h3>
                            Vue.js
                        </h3>
                        <div class="progressBar">
                            <div class="progress" data-score="60" style="width: 0%"></div>
                        </div>
                    </li>
                    <li>
                        <h3>
                            React.js
                        </h3>
                        <div class="progressBar">
                            <div class="progress" data-score="50" style="width: 0%"></div>
                        </div>
                    </li>
                    <li>
                        <h3>
                            Node.js
                        </h3>
                        <div class="progressBar">
                            <div class="progress" data-score="80" style="width: 0%"></div>
                        </div>
                    </li>
                </ol>
            </article>


            <article id="portfolio" class="portfolio" data-bbtn="to_portfolio">
                <h2>作品集</h2>
                <!-- <nav>
                    <ol class="portfolio-tab"">
                        <li data-state=" state-1">所有</li>
                        <li data-state="state-2">框架</li>
                        <li data-state="state-3">原生JS&amp;CSS</li>
                    </ol>

                    <div id="portfolioBar" class="bar state-1">
                        <div class="bar-inner"></div>
                    </div>
                </nav>

                <div id="works" class="works state-1">
                    <a href="javascript:;" rel="作品1">1</a>
                    <a href="javascript:;" rel="作品2">2</a>
                    <a href="javascript:;" rel="作品3">3</a>
                </div> -->
                <div class="wrap">
                    <div id="slide-box">
                        <div class="slide-window page-1">
                            <a href="#"></a>
                            <a href="#"></a>
                            <a href="#"></a>
                            <a href="#"></a>
                            <a href="#"></a>
                        </div>
                    </div>

                    <div class="btns">
                        <button id="page-1" class="actived">壹</button>
                        <button id="page-2">贰</button>
                        <button id="page-3">叁</button>
                        <button id="page-4">肆</button>
                        <button id="page-5">伍</button>
                    </div>
                </div>
            </article>




            <article class="message-board">
                <div class="title"><span id="msgcount">0</span>条留言</div>
                <ul class="list" id="msglist">

                </ul>
                <div class="editpad">
                    <div id="editbox" contenteditable></div>
                    <button id="btn-submit">发布</button>
                </div>

                <script src="//cdn.jsdelivr.net/npm/leancloud-storage@3.14.1/dist/av-min.js"></script>

                <script>
                    function createAV() {
                        var {
                            Query,
                            User
                        } = AV;
                        var APP_ID = 'v1BwTCTg5NzRzGA32sKnVkSV-gzGzoHsz'; //虽然ID和KEY是从帮助中直接复制的，但该网站已经做了动态生成处理，所以可以直接用
                        var APP_KEY = 'Up4FU9MpCNByIEjdx4iEBxHD';

                        AV.init({
                            appId: APP_ID,
                            appKey: APP_KEY
                        });
                    }
                    createAV();

                    function connectRemoteTable(tableName) {

                        var TableObject = AV.Object.extend(
                            tableName); //这个TestObject会在云上生成一个新的数据表 表名：TestObject                        
                        return new TableObject()

                        //测试调用begin
                        // var TestObject = AV.Object.extend('TestObject'); //这个TestObject会在云上生成一个新的数据表 表名：TestObject
                        // var testObject = new TestObject();
                        // testObject.save({
                        //     words: 'Hello World!'  //words 就是代表列名，如果输入不存在的KEY就会在表中生成一个新列
                        // }).then(function (object) {
                        //     alert('LeanCloud Rocks!');
                        // })
                        //测试调用end
                        //localStorage.setItem('debug', 'leancloud*,LC*'); 调试的话，可以在控制面板中输入这个   401就是APPID有误
                    }
                    //leanCloud()

                    let message = "";
                    let islock = false; //防多次点击提交       
                    //获取输入框的值             
                    document.querySelector("#editbox").addEventListener("keyup", function (e) {
                        message = e.currentTarget.textContent;
                    })
                    //用于制作输入框的默认信息，信息内容在CSS里
                    document.querySelector("#editbox").addEventListener("focusout", function (e) {
                        if (message) {
                            e.currentTarget.classList.add("hascontent")
                        } else {
                            e.currentTarget.classList.remove("hascontent")
                        }
                    })
                    //提交
                    document.querySelector("#btn-submit").addEventListener("click", function (e) {
                        if (message) {
                            addmsg(setData({
                                msg: message
                            }), (resultObj) => {

                                let iDate = new Date(resultObj.createdAt);
                                let dateStr =
                                    `${iDate.getFullYear()}-${iDate.getMonth()+1}-${iDate.getDate()}`

                                let domstr = createMSGMod(message, dateStr);
                                document.querySelector("#msglist").appendChild(domstr);
                                document.querySelector("#editbox").textContent = ""; //清空输入框
                                message = "";
                            });
                        }
                    })




                    var table = connectRemoteTable('TestObject');
                    //方便数据过滤用的，这样可以保证列名不会用错
                    function setData({
                        msg,
                        like
                    }) {
                        return {
                            message: msg, //DOM获取
                            like: like, //点赞 默认总是0 
                        }
                    }
                    /**
                     * 使用leanCloud技术 连接到云数据库，把内容保存到远程表中
                     * 
                     */
                    function getmsg(callback) {
                        new AV.Query('TestObject').find().then(function (object) {
                            if (callback) {
                                callback(object)
                            }
                        })
                    }

                    function giveDom() {

                        getmsg((results) => {

                            let count = results.length;
                            let ulDom = document.getElementById("msglist");
                            if (count > 0) {
                                document.querySelector("#msgcount").textContent = count;


                                results.map(item => {
                                    let iDate = new Date(item.createdAt);
                                    let dateStr =
                                        `${iDate.getFullYear()}-${iDate.getMonth()+1}-${iDate.getDate()}`;

                                    ulDom.appendChild(createMSGMod(item.attributes
                                        .message, dateStr))
                                });

                            }

                        })
                    }

                    function createMSGMod(msg, date) {
                        let lidom = document.createElement("li");
                        lidom.innerHTML = `<p class="list-content">${msg}</p>
                                        <p class="msg-date">${date}</p>`;
                        return lidom;

                    }



                    giveDom();
                    //增加一条
                    function addmsg(data, callback) {
                        table.save(data).then(function (object) {
                            if (callback) {
                                callback(object)
                            }
                        })
                    }
                </script>
            </article>

        </main>


    </div>



    <div id="mask">
        <p id="loadmsg" style="margin:20px;font-size:12px;"></p>
        <span>LOADING...</span>
    </div>


    <script src="js/common.js"></script>
    <script src="js/loadimg.js"></script>
    <script src="js/slider.js"></script>
    <script src="js/stickbar.js"></script>
    <script src="js/barhighlight.js"></script>

</body>

</html>